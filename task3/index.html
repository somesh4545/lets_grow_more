<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <!-- Latest compiled and minified CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <!-- font awesome -->
    <script
      src="https://kit.fontawesome.com/2862b9c025.js"
      crossorigin="anonymous"
    ></script>

    <!-- animations -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />

    <style>
      * {
        margin: 0;
        padding: 0;
      }

      body {
        height: 100vh;
        background: #fff;
        /* background-image: linear-gradient(to right, #d94bef, #8249ed); */
      }

      .nav {
        display: flex;
        align-items: center;
        height: 10vh;
        /* background-color: #000; */
      }

      .comapny_name {
        font-size: 25px;
        font-weight: 800;
        color: #000;
        margin: 0px;
      }

      .main_container {
        height: 90vh;
        /* background-color: #ddd; */
      }

      .left {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 90vh;
      }

      .landing_img {
        height: 60vh;
        width: 600px;
        animation: MoveUpDown 5s linear infinite;
      }
      @keyframes MoveUpDown {
        0%,
        100% {
          bottom: -25px;
        }
        50% {
          margin-top: 25px;
        }
      }
      .right {
        display: flex;
        flex-direction: column;
        justify-content: center;
        /* align-items: center; */
        /* background: #f6f6f6; */
        height: 90vh;
      }

      .main {
        display: block;
      }

      .title {
        color: #000080;
        font-size: 40px;
        font-weight: 600;
      }

      .subtitle {
        font-size: 18px;
        line-height: 30px;
        font-weight: 400;
        color: #3f3f3f;
        margin: 30px 0px;
      }

      .loginBox {
        display: flex;
        flex-direction: row;
        margin-top: 10px;
      }

      .loginContainer {
        display: flex;
        margin-right: 30px;
        /* justify-content: center; */
        align-items: center;
      }

      .loginBtn {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 150px;
        height: 40px;
        border-radius: 10px;
        color: #fff;
        background-color: #000080;

        outline: none;
        border: none;
      }

      .student_login {
        display: none;
        flex-direction: column;
        /* background-color: #000; */
        padding: 15px;
        min-height: 200px;
      }

      .teacher_login {
        display: none;
        padding: 15px;
      }

      .back_btn {
        border: none !important;
        outline: none;
        background-color: transparent;
      }

      .back_icon {
        font-size: 25px;
        color: #000080;
      }

      .back_icon:hover {
        cursor: pointer;
      }

      .login_title {
        display: flex;
        flex-direction: row;
        align-items: center;
        margin: 20px 0px;
      }

      .login_heading {
        font-size: 40px;
        font-weight: 600;
        color: #000080;
      }

      .login_subtitle {
        margin-left: 15px;
        color: #6f6f6f;
      }

      .login_form {
        display: flex;
        flex-direction: column;
      }

      .f_input {
        margin: 15px 0px;
        border: none;
        font-size: 20px;
        padding: 5px 10px;
        outline: none;
        border-bottom: 1px solid #000;
      }

      .f_btn {
        width: 150px;
        height: 35px;
        color: #fff;
        font-size: 20px;
        border-radius: 5px;
        outline: none;
        border: none;
        margin: 15px 0px;
        background-color: #000080;
      }

      /* captcha styling */
      .captcha_container {
        margin: 15px 0px;
      }
      .captcha_box {
        display: flex;
        flex-direction: row;
        align-items: center;
      }
      .captcha {
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: "Comic Sans MS", cursive, sans-serif;
        font-style: italic;
        font-weight: bold;
        font-size: 20px;
        width: 120px;
        padding: 5px 5px;
        border-radius: 5px;
        text-decoration: line-through;
        color: #a0a0a0;
        background-color: #0c0c0c;
      }

      .restart a {
        margin-left: 15px;
        text-decoration: none;
      }

      .errmsg {
        color: black;
        padding: 5px 15px;
        transition: 0.5s ease;
      }
    </style>
  </head>

  <body>
    <div class="nav container">
      <span class="comapny_name">Edu</span>
    </div>
    <div class="main_container">
      <div class="container">
        <div class="row">
          <div class="col-sm-6 left">
            <img src="./assets/landing.png" class="landing_img" alt="" />
          </div>
          <div class="col-sm-6 right">
            <div class="main">
              <h1 class="title">The best education starts here</h1>
              <h4 class="subtitle">
                A life without education is valueless. Education makes
                oneself-sufficient, knowledgeable, intelligent, independent and
                boosts self-confidence. It enhances our thought process and
                enables us to do things creatively and correctly.
              </h4>
              <div class="loginBox">
                <div class="loginContainer" id="student">
                  <button class="loginBtn">Login as Student</button>
                </div>
                <div class="loginContainer" id="teacher">
                  <button class="loginBtn">Login as Teacher</button>
                </div>
              </div>
            </div>
            <div class="student_login">
              <button class="back_btn" onclick="showMain()">
                <i class="fas fa-arrow-left back_icon"></i>
              </button>
              <div class="login_title">
                <span class="login_heading">Login</span>
                <span class="login_subtitle">for student</span>
              </div>
              <form
                class="login_form"
                autocomplete="off"
                onsubmit="studentLogin()"
              >
                <input
                  type="text"
                  name="enroll_no"
                  id="enroll_no"
                  class="f_input"
                  placeholder="Enrollment number"
                  value="1906124"
                  required
                />
                <input
                  type="password"
                  name="s_password"
                  id="s_password"
                  class="f_input"
                  placeholder="Password"
                  value="somesh"
                  required
                />
                <div class="captcha_container">
                  <div class="captcha_box">
                    <div id="captcha" class="captcha"></div>
                    <div class="restart">
                      <a href="#" onclick="createCaptcha()">Change</a>
                    </div>
                  </div>
                  <div class="input">
                    <input
                      type="text"
                      name="reCaptcha"
                      class="f_input"
                      id="reCaptcha"
                      placeholder="Type The Captcha"
                      required
                    />
                  </div>
                  <div id="errCaptcha" class="errmsg"></div>
                </div>
                <button class="f_btn">Login</button>
              </form>
            </div>
            <div class="teacher_login">
              <button class="back_btn" onclick="showMain()">
                <i class="fas fa-arrow-left back_icon"></i>
              </button>
              <div class="login_title">
                <span class="login_heading">Login</span>
                <span class="login_subtitle">for teacher</span>
              </div>
              <form
                class="login_form"
                autocomplete="off"
                onsubmit="teacherLogin()"
              >
                <input
                  type="text"
                  name="t_id"
                  id="t_id"
                  value="1234"
                  class="f_input"
                  placeholder="Teacher ID"
                  required
                />
                <input
                  type="password"
                  name="t_password"
                  id="t_password"
                  value="t@1234"
                  class="f_input"
                  placeholder="Password"
                  required
                />
                <div id="errMsg" class="errmsg"></div>
                <button class="f_btn">Login</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      // ajx fucntion to check login status on document load
      window.onload = function () {
        $.ajax({
          type: "POST",
          url: "./backend/login.php",
          data: "login_status",
        }).done((data) => {
          if (data == "false") {
            console.log("not logged in");
          } else {
            console.log(data);
            if (data == "student") {
              location.href = "./Student";
            }
            if (data == "teacher") {
              location.href = "./Teacher";
            }
            console.log("already logged in");
          }
        });
      };

      // get all the main, student_login and teacher_login componet
      var main = document.querySelector(".main");
      var student_login = document.querySelector(".student_login");
      var teacher_login = document.querySelector(".teacher_login");

      // showing main option screen
      function showMain() {
        student_login.style.display = "none";
        teacher_login.style.display = "none";
        main.style.display = "block";
      }

      // listner to student login on press
      var student_login_btn = document.getElementById("student");
      student_login_btn.addEventListener("click", () => {
        createCaptcha();
        main.style.display = "none";
        teacher_login.style.display = "none";
        student_login.style.display = "block";
      });

      // listner to teacher login on press
      var teacher_login_btn = document.getElementById("teacher");
      teacher_login_btn.addEventListener("click", () => {
        main.style.display = "none";
        teacher_login.style.display = "block";
      });

      // captcha code to student login
      let captcha = new Array();

      function createCaptcha() {
        const activeCaptcha = document.getElementById("captcha");
        for (q = 0; q < 4; q++) {
          if (q % 2 == 0) {
            captcha[q] = String.fromCharCode(
              Math.floor(Math.random() * 26 + 65)
            );
          } else {
            captcha[q] = Math.floor(Math.random() * 10 + 0);
          }
        }
        theCaptcha = captcha.join("");
        activeCaptcha.innerHTML = `${theCaptcha}`;
        document.getElementById("reCaptcha").value = theCaptcha;
      }

      const errCaptcha = document.getElementById("errCaptcha");
      function validateCaptcha() {
        const reCaptcha = document.getElementById("reCaptcha");
        recaptcha = reCaptcha.value;
        let validateCaptcha = 0;
        for (var z = 0; z < 4; z++) {
          if (recaptcha.charAt(z) != captcha[z]) {
            validateCaptcha++;
          }
        }
        if (recaptcha == "") {
          errCaptcha.innerHTML = "Re-Captcha must be filled";
          errCaptcha.style.background = "#ddd";
          return false;
        } else if (validateCaptcha > 0) {
          errCaptcha.innerHTML = "Wrong captcha";
          errCaptcha.style.background = "red";
          errCaptcha.style.color = "#fff";
          return false;
        } else {
          // errCaptcha.innerHTML = "Done";
          return true;
        }
      }

      // student login fucntion
      function studentLogin() {
        event.preventDefault();
        // errCaptcha.innerHTML = "";
        if (validateCaptcha()) {
          var formData = {
            enroll_no: document.getElementById("enroll_no").value,
            s_password: document.getElementById("s_password").value,
          };
          $.ajax({
            type: "POST",
            url: "./backend/login.php",
            data: formData,
          }).done((data) => {
            console.log(data);
            if (data == "true") {
              location.href = "./Student/";
            } else {
              errCaptcha.innerHTML = "Wrong details. Try again";
              errCaptcha.style.background = "red";
              errCaptcha.style.color = "#fff";
            }
            // console.log(formData);
          });
        } else {
          createCaptcha();
        }
      }

      function teacherLogin() {
        event.preventDefault();
        var formData = {
          t_id: document.getElementById("t_id").value,
          t_password: document.getElementById("t_password").value,
        };
        $.ajax({
          type: "POST",
          url: "./backend/login.php",
          data: formData,
        }).done((data) => {
          console.log(data);
          if (data == "true") {
            location.href = "./Teacher";
          } else {
            let errorDiv = document.getElementById("errMsg");
            errorDiv.innerHTML = "Wrong details. Try again";
            errorDiv.style.background = "red";
            errorDiv.style.color = "#fff";
          }
        });
      }
    </script>
  </body>
</html>
